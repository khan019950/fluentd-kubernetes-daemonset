# AUTOMATICALLY GENERATED
# DO NOT EDIT THIS FILE DIRECTLY, USE /templates/conf/fluent.conf.erb

@include "#{ENV['FLUENTD_SYSTEMD_CONF'] || 'systemd'}.conf"
@include "#{ENV['FLUENTD_PROMETHEUS_CONF'] || 'prometheus'}.conf"
@include kubernetes.conf
@include conf.d/*.conf

<match **>
  @type mongo
  connection_string "#{ENV['FLUENT_MONGO_CONNECTION_URI']}"
  collection "#{ENV['FLUENT_MONGO_COLLECTION'] || 'fluentd'}"
  <buffer>
    flush_thread_count "#{ENV['FLUENT_MONGO_BUFFER_FLUSH_THREAD_COUNT'] || '8'}"
    flush_mode interval "#{ENV['FLUENT_MONGO_BUFFER_FLUSH_FLUSH_MODE'] || 'interval'}"
    flush_interval "#{ENV['FLUENT_MONGO_BUFFER_FLUSH_INTERVAL'] || '5s'}"
    chunk_limit_size "#{ENV['FLUENT_MONGO_BUFFER_CHUNK_LIMIT_SIZE'] || '2M'}"
    queue_limit_length "#{ENV['FLUENT_MONGO_BUFFER_QUEUE_LIMIT_LENGTH'] || '32'}"
    retry_max_interval "#{ENV['FLUENT_MONGO_BUFFER_RETRY_MAX_INTERVAL'] || '30'}"
    retry_forever true
  </buffer>
</match>